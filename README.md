# Wind Turbine Blade Monitoring using Thermal Images and RAG with LLM 
This project presents a decision support system for detecting and analyzing **thermal turbulence patterns (TTPs)** on wind turbine blades using **YOLOv11**, **K-Means clustering**, **FAISS similarity search**, and **LLM-based Retrieval-Augmented Generation (RAG)**. It aims to automate fault detection and provide interpretable, context-based recommendations for wind turbine maintenance.

## üìå Features

- **YOLOv11 Object Detection**  
  Detects thermal turbulence patterns (TTPs) in thermal images with a mean Average Precision (mAP@0.5) of **81.1%**.

- **TTP Clustering**  
  K-Means clustering groups TTPs into 5 visual categories; clusters are manually assigned damage types (crack, erosion, delamination, lightning damage, icing damage).

- **FAISS Similarity-Based Classification**  
  New TTP detections are matched to similar clustered features and classified based on majority vote.

- **RAG LLM System**  
  A Retrieval-Augmented Generation (RAG) pipeline retrieves relevant content from technical documentation based on the detected damage type and the user's query. This context is passed to a locally hosted LLM (Gemma 3 4B) to generate informed, domain-specific responses.

- **[OpenWebUI](https://github.com/open-webui/open-webui) Integration**  
  A chat interface allows uploading thermal images, detecting damage, retrieving documentation, and receiving the LLM response all in one interaction.

## üìÅ Directory Structure

### `data/`
- **`data/pdfs/`**  
  Contains wind turbine-related documents used in the RAG (Retrieval-Augmented Generation) component for context-aware querying.

- **`data/similarity_search/`**  
  Stores outputs generated by `cluster_ttps.py`, including clustered representations for similarity search.

- **`data/yolo_dataset/`**  
  Includes the dataset used for training the YOLO model. Based on the original KI-VISIR dataset, this version has been enhanced using **CLAHE** (Contrast Limited Adaptive Histogram Equalization) and **Unsharp masking**. The dataset also contains 10% background images (no annotations)

### `cluster_ttps.py`  
Clusters all TTPs from the training set into damage categories, plots the clusters, and creates the FAISS index for similarity search
  
### `yolo_model/`
Contains the best-performing YOLO model's results, along with its associated hyperparameters and data augmentation settings.

### `YOLOv11.ipynb`
Jupyter Notebook used for training the YOLOv11 model. Training was performed on **Google Colab**.

### `pipelines/`
A cloned version of the [OpenWebUI's Pipelines](https://github.com/open-webui/pipelines) plugin framework.

- The full workflow is implemented in:
  - **`pipelines/pipelines/WTaid.py`**

## Requirements
- **Python 3.11 or higher**
- **[Ollama](https://github.com/ollama/ollama)**
- **GPU with at least 8GB RAM** (for RAG and LLM)

## üõ†Ô∏è Setup Instructions
1. Install Open WebUI
   ```bash
   pip install open-webui
   ```
3. **Clone the repository**:
   ```bash
   git clone https://github.com/chnor01/TurbineAid.git
   cd TurbineAid
   ```
4. **Create virtual environment**
   ```bash
   python -m venv openwebui
   openwebui\Scripts\activate
   ```
5. Install dependencies
   ```bash
   pip install -r requirements.txt
   ```
6. Start servers
   ```bash
   open-webui serve
   ollama serve
   ```
   ```bash
   cd pipelines; ./start.bat
   ```
   
### Project Demo
https://github.com/user-attachments/assets/80683799-9ae2-4f0c-9332-f8e7436d95c3   
